---
layout: mypost
title:  "RTC在云游戏场景下的架构思考"
date:   2022-1-030 08:13:17 +0800
categories: rtc
location: ShangHai,China 
---
---

### 架构设计

我一直认为在完全陌生的场景是没法做到"预判设计"的，每次写代码都是需要先动手、后调整，所以说架构师一定是工作多年、经验十分丰富的工程师才能担当的岗位。

我工作才三年半，断然是没有这个能力的。但是在"webrtc的应用"这个领域，我已经学习、实践了三年，已经有经验和能力来谈谈这个"云游戏场景下的架构设计"。

在RTC这个场景下我总共看过4种不同的设计: 顺网云电脑、intel owt、阿里视频会议、米哈游云游戏(探索版)。

我认为就"intel owt"谈得上是一个"设计"，其他几个都是"架构师按照过往项目，死搬硬套的项目模板"而已，并没有在RTC这个场景下因地制宜。

### 拆分

程序会有三大部分: 业务 + RTC + 音视频引擎。

为什么会把业务单独拿出来?
> RTC领域存在门槛(虽然不高),导致普通C++程序员不理解RTC相关的术语，更不理解程序流程。如果RTC代码和业务代码在一起，会给专职"逻辑"开发工程造成很大的干扰。

为什么要把音视频引擎单独拿出来?
> 这部分的代码的功能是相对独立、自洽的，也没有什么业务。从开发人员的日常开发过程上考虑，不和webrtc绑在一起具有更大的灵活性与便捷性。并且webrtc天然就是这种设计。

我觉得实践过程中还需要根据市场上的人员情况、CI\CD流程、所在公司实际的环境、组员的分工等再进一次微调，该加封装的地方加封装、该隔离的地方隔离。

### 模块间的关系

webrtc的代码设计的非常巧妙，可以做到将"音视频编解码、渲染"完全外置，只包含"传输"的代码。

我认为上层"rtc"的封装也应该参考webrtc,针对音视频的部分使用这种这种设计:"由RTC来定义音视频的API, 然后外部的实现模块对着这个API来做"。按照这种架构的代码，在"音视频" 和 "rtc" 上可以做到完全"模块化"! 

可惜实践过程不尽人意，组内人员对软件架构都有自己的理解，再加上人微言轻，我的见解最终没有被采纳

(未完待续)

