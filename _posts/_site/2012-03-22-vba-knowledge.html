<h3 id="创建一个-excel-工作簿对象">创建一个 EXCEL 工作簿对象</h3>

<pre><code class="language-vbnet">Set wd = CreateObject("excel.application")
Set MyWorkBook = wd.Workbooks.Open(".XXXX.xls")
</code></pre>

<p>用完后 <code class="highlighter-rouge">wd.Quit</code></p>

<h3 id="设置边框与自动筛选">设置边框与自动筛选</h3>

<pre><code class="language-vbnet">Set Rng = MyWorkSheet.UsedRange
With Rng
    .Borders.LineStyle = xlContinuous
    .Borders.Weight = xlThin
    .AutoFilter
End With
</code></pre>

<h3 id="获取或者设置单元格背景色">获取或者设置单元格背景色</h3>

<pre><code class="language-vbnet">MyWorkSheet.Cells(i, j).Interior.ColorIndex
</code></pre>

<h3 id="保存--关闭工作簿">保存 / 关闭工作簿</h3>

<pre><code class="language-vbnet">MyWorkBook.Save
MyWorkBook.Close
</code></pre>

<h3 id="让某表格选中的单元格变成指定颜色">让某表格选中的单元格变成指定颜色</h3>

<p>在 thisworkbook 中添加如下代码段：</p>

<pre><code class="language-vbnet">Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)
    If ActiveSheet.Name = "yoursheet" Then
        ActiveSheet.UsedRange.Interior.ColorIndex = 0
        Target.Interior.ColorIndex = 6
    End If
End Sub
</code></pre>

<h3 id="引用单元格--区域">引用单元格 / 区域</h3>

<pre><code class="language-vbnet">Range("A1") '表示 A1 单元格
Range("A2:D1") '表示 A2 到 D1 区域
Range("A2:D1")(3) '表示该区域里的第三个单元格
Range("D" &amp; i) 'i 为变量
Range("D3:F4,G10") '引用多个区域
Range("2:2") '引用第二行
Range("2:12") '引用第二行到第十二行
Range("D:A") '引用第 A 到 D 列
Rows(2) '引用第二行
Rows("2:4") '引用第二到四行
Columns("B")
Columns("B:D")
Range(Clee1, Cell2) '左上与右下
Range(Range1, Range2) '取最大范围
</code></pre>

<h3 id="选中单元格--区域">选中单元格 / 区域</h3>

<pre><code class="language-vbnet">Range("1:1").Select '选中第一行
</code></pre>

<h3 id="获取当前选中区域">获取当前选中区域</h3>

<pre><code class="language-vbnet">MyWorkSheet.Application.Selection
</code></pre>
