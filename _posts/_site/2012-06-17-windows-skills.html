<p><strong>目录</strong></p>

<ul id="markdown-toc">
  <li><a href="#win7-不按-shift右键显示-在此处打开命令窗口-w" id="markdown-toc-win7-不按-shift右键显示-在此处打开命令窗口-w">Win7 不按 Shift，右键显示 “在此处打开命令窗口 (W)”</a></li>
  <li><a href="#win7-搜索文件内容" id="markdown-toc-win7-搜索文件内容">Win7 搜索文件内容</a></li>
  <li><a href="#将-caps-lock-映射为-ctrl" id="markdown-toc-将-caps-lock-映射为-ctrl">将 Caps Lock 映射为 Ctrl</a></li>
</ul>

<h3 id="win7-不按-shift右键显示-在此处打开命令窗口-w">Win7 不按 Shift，右键显示 “在此处打开命令窗口 (W)”</h3>

<p><img src="/images/posts/windowsskill/rclick.png" alt="Windows Skills" /></p>

<p>图上的这条右键命令一般在 Win7 下是需要 Shift + 右键在弹出菜单里才能看到的，怎么省掉这个 Shift，直接就能出来呢？</p>

<p>先说方法：</p>

<p>将如下代码保存为 .reg 文件然后执行即可。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\Directory\shell\cmd]
"Extended"=-

[HKEY_CLASSES_ROOT\Drive\shell\cmd]
"Extended"=-

[HKEY_CLASSES_ROOT\LibraryFolder\background\shell]
@="none"

[HKEY_CLASSES_ROOT\LibraryFolder\background\shell\cmd]
@="@shell32.dll,-8506"
"NoWorkingDirectory"=""
"Extended"=-

[HKEY_CLASSES_ROOT\LibraryFolder\background\shell\cmd\command]
@="cmd.exe /s /k pushd \"%V\""
</code></pre>
</div>

<p>再说原理：</p>

<ol>
  <li>
    <p>普通文件夹右键</p>

    <p>将注册表 HKEY_CLASSES_ROOT\Directory\Background\shell\cmd 下的键 Extended 改名或者删除</p>
  </li>
  <li>
    <p>磁盘分区右键</p>

    <p>将注册表 HKEY_CLASSES_ROOT\Drive\shell\cmd 下的键 Extended 改名或者删除</p>
  </li>
  <li>
    <p>库文件夹右键</p>

    <p>在注册表 HKEY_CLASSES_ROOT\LibraryFolder\background 下建立和第一条的 Directory\Background 中相同的键值</p>
  </li>
</ol>

<h3 id="win7-搜索文件内容">Win7 搜索文件内容</h3>

<p>控制面板 – 索引选项 – 高级 – 文件类型 – 找到你想要搜索内容的文件后缀名，点中它，然后选中下面的「为属性和文件内容添加索引」。</p>

<h3 id="将-caps-lock-映射为-ctrl">将 Caps Lock 映射为 Ctrl</h3>

<p><strong>注：</strong>经验证此方法也适用于 Win10，但是完成后需要<strong>重启</strong>。</p>

<p>因为个人习惯输入大写字母时使用「Shift + 字母」的方式，所以 Caps Lock 键并没有什么用，而且经常使用 Vim，偶尔使用 Emacs，都需要频繁地按 Ctrl 键，在 Mac OS X 下已经将 Caps Lock 键映射为 Ctrl，为了统一体验和按键方便，也需要在 Windows 下做一个映射。</p>

<p>先说方法：</p>

<p>将如下代码保存为 .reg 文件然后执行即可。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout]
"Scancode Map"=hex:00,00,00,00,00,00,00,00,02,00,00,00,1d,00,3a,00,00,00,00,00
</code></pre>
</div>

<p>再说原理：</p>

<p>Scancode Map 这个键值的讲解实例参见 <a href="https://msdn.microsoft.com/en-us/library/windows/hardware/jj128267(v=vs.85).aspx#code-snippet-1">Keyboard and mouse class drivers (Windows Drivers)</a>，我们这里填写的值</p>

<div class="highlighter-rouge"><pre class="highlight"><code>00000000 00000000 02000000 1d003a00 00000000
</code></pre>
</div>

<p>可以对应理解如下：</p>

<table>
  <thead>
    <tr>
      <th>值</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x00000000</td>
      <td>Header: 版本。全部设置为 0。</td>
    </tr>
    <tr>
      <td>0x00000000</td>
      <td>Header: 标志。全部设置为 0。</td>
    </tr>
    <tr>
      <td>0x00000002</td>
      <td>2 条映射条目（包括结尾的 null 条目）。</td>
    </tr>
    <tr>
      <td>0x003a001d</td>
      <td>Caps Lock –&gt; Left Ctrl (0x3a –&gt; 0x1d).</td>
    </tr>
    <tr>
      <td>0x00000000</td>
      <td>终止符，即 null 条目。</td>
    </tr>
  </tbody>
</table>
