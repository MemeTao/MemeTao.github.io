---
layout: post
title:  "局域网下时间同步(精度100us)"
date:   2019-1-22 11:13:17 +0800
categories: algorithm
location: HangZhou,China 
description:
---
---

### 介绍
本文介绍在**非异常恶劣**的网络中，如何同步两台机器的本地时间，我们的目标是**尽量(大概率上)**将时间同步的误差控制在0.1ms。

众所周知，网络中存在time服务器，利用ntp协议可以将网络中主机的本地时间同步到1s的误差范围。对于正常应用，这个精度应该是够的。但是总存在一些特殊应用，它对时间的精度要求更高。在这种情况下，time服务已经不满足我们的需要了。

### 基本方式
在ping模式下，机器A发送一个包，并记录发包时间t1，机器B收到Icmp包后发送ack包，机器A收到ack包后记录收包时间t2，t2减t1就被认为是rtt。

